<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Count Down to Last Orders - Music Production for Max & Maisie</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #2563eb;
            --primary-light: #3b82f6;
            --secondary-green: #10b981;
            --secondary-light: #34d399;
            --accent-orange: #f59e0b;
            --danger-red: #ef4444;
            --bg-white: #ffffff;
            --bg-light: #f9fafb;
            --bg-gray: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --border-color: #e5e7eb;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: var(--bg-white);
            border-bottom: 3px solid var(--primary-blue);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 5px;
        }

        .tagline {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .kids-reminder {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-light));
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
        }

        /* Daily Blog Section */
        .blog-section {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            border-left: 5px solid var(--primary-blue);
        }

        .blog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .blog-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .blog-date {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .blog-prompt {
            background: var(--bg-gray);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: var(--text-secondary);
            font-style: italic;
        }

        .blog-textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .blog-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .blog-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: flex-end;
        }

        .blog-history {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid var(--border-color);
        }

        .blog-entry {
            background: var(--bg-gray);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .blog-entry-date {
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        .blog-entry-text {
            color: var(--text-primary);
            white-space: pre-wrap;
        }

        /* Navigation Tabs */
        .tab-nav {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            display: flex;
            gap: 8px;
            overflow-x: auto;
        }

        .tab-btn {
            padding: 14px 24px;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            background: var(--bg-gray);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--primary-blue);
            color: white;
        }

        /* Wheel Section */
        .wheel-section {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .wheel-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .wheel-subtitle {
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto 40px;
        }

        @media (max-width: 768px) {
            .wheel-container {
                width: 300px;
                height: 300px;
            }
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.15);
            border: 8px solid var(--border-color);
            background: white;
        }

        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: right bottom;
        }

        .wheel-segment:nth-child(1) { 
            transform: rotate(0deg); 
            background: #2563eb;
        }
        .wheel-segment:nth-child(2) { 
            transform: rotate(51.43deg); 
            background: #3b82f6;
        }
        .wheel-segment:nth-child(3) { 
            transform: rotate(102.86deg); 
            background: #10b981;
        }
        .wheel-segment:nth-child(4) { 
            transform: rotate(154.29deg); 
            background: #34d399;
        }
        .wheel-segment:nth-child(5) { 
            transform: rotate(205.71deg); 
            background: #f59e0b;
        }
        .wheel-segment:nth-child(6) { 
            transform: rotate(257.14deg); 
            background: #fbbf24;
        }
        .wheel-segment:nth-child(7) { 
            transform: rotate(308.57deg); 
            background: #a78bfa;
        }

        .wheel-segment::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: inherit;
            clip-path: polygon(100% 100%, 0 100%, 100% 0);
        }

        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary-blue);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        .wheel-labels {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .wheel-label {
            position: absolute;
            font-weight: 600;
            font-size: 0.85rem;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            width: 150px;
            text-align: center;
            transform-origin: center;
        }

        .wheel-label:nth-child(1) {
            top: 25%;
            left: 50%;
            transform: translateX(-50%) translateY(-50%);
        }

        .wheel-label:nth-child(2) {
            top: 35%;
            right: 15%;
            transform: rotate(30deg);
        }

        .wheel-label:nth-child(3) {
            bottom: 35%;
            right: 15%;
            transform: rotate(60deg);
        }

        .wheel-label:nth-child(4) {
            bottom: 20%;
            left: 50%;
            transform: translateX(-50%);
        }

        .wheel-label:nth-child(5) {
            bottom: 35%;
            left: 15%;
            transform: rotate(-60deg);
        }

        .wheel-label:nth-child(6) {
            top: 35%;
            left: 15%;
            transform: rotate(-30deg);
        }

        .wheel-label:nth-child(7) {
            top: 15%;
            left: 35%;
        }

        .wheel-pointer {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 50px solid var(--danger-red);
            z-index: 20;
            filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
        }

        .spin-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-light));
            color: white;
            border: none;
            padding: 20px 60px;
            border-radius: 8px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-lg);
        }

        .spin-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.2);
        }

        .spin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .wheel-result {
            margin-top: 30px;
            padding: 25px;
            background: var(--bg-gray);
            border-radius: 12px;
            border-left: 5px solid var(--secondary-green);
            display: none;
        }

        .wheel-result.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .wheel-result h3 {
            font-size: 1.5rem;
            color: var(--primary-blue);
            margin-bottom: 10px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            text-align: center;
            border-top: 4px solid var(--primary-blue);
        }

        .stat-card.highlight {
            border-top-color: var(--secondary-green);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .stat-card.highlight .stat-value {
            color: var(--secondary-green);
        }

        .stat-subtext {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Content Cards */
        .content-card {
            background: var(--bg-white);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .content-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        /* Tracker */
        .drink-counter {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
        }

        .counter-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }

        .counter-btn.minus {
            background: var(--bg-gray);
            color: var(--text-secondary);
        }

        .counter-btn.plus {
            background: var(--accent-orange);
            color: white;
        }

        .counter-btn:hover {
            transform: scale(1.1);
        }

        .counter-display {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            min-width: 100px;
            text-align: center;
        }

        /* Calendar */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-top: 20px;
        }

        .calendar-header {
            font-weight: 600;
            text-align: center;
            color: var(--text-secondary);
            padding: 10px 0;
        }

        .calendar-day {
            aspect-ratio: 1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg-gray);
            border: 2px solid transparent;
        }

        .calendar-day.free {
            background: var(--secondary-green);
            color: white;
        }

        .calendar-day.partial {
            background: var(--accent-orange);
            color: white;
        }

        .calendar-day.heavy {
            background: var(--danger-red);
            color: white;
        }

        .calendar-day:hover {
            transform: scale(1.1);
            border-color: var(--primary-blue);
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--bg-gray);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        .btn-success {
            background: var(--secondary-green);
            color: white;
        }

        .btn-success:hover {
            background: var(--secondary-light);
            transform: translateY(-2px);
        }

        .btn-full {
            width: 100%;
        }

        /* Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .achievement-card {
            background: var(--bg-gray);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
            border: 3px solid transparent;
            position: relative;
        }

        .achievement-card.unlocked {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-light));
            color: white;
        }

        .achievement-card.unlocked::after {
            content: 'EARNED';
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--secondary-green);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
        }

        .achievement-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .achievement-name {
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .achievement-desc {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Progress Section */
        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .progress-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .progress-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .kids-reminder {
                font-size: 1rem;
                padding: 10px 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .tab-btn {
                font-size: 0.9rem;
                padding: 10px 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div>
                    <h1>Count Down to Last Orders</h1>
                    <p class="tagline">I'm a man, a son, a brother and a father</p>
                </div>
                <div class="kids-reminder">
                    For Max & Maisie
                </div>
            </div>
        </div>

        <!-- Daily Blog Section -->
        <div class="blog-section">
            <div class="blog-header">
                <h2 class="blog-title">Daily Reflection</h2>
                <span class="blog-date" id="todayDate"></span>
            </div>
            
            <div class="blog-prompt" id="blogPrompt">
                Today's prompt: What would Max and Maisie be proud of you for today?
            </div>
            
            <textarea 
                class="blog-textarea" 
                id="dailyBlog" 
                placeholder="Write your thoughts here. This is your space to reflect on your journey, your motivations, and your progress. Think about Max and Maisie - what example are you setting today?"
            ></textarea>
            
            <div class="blog-actions">
                <button class="btn btn-secondary" onclick="clearBlog()">Clear</button>
                <button class="btn btn-primary" onclick="saveBlog()">Save Entry</button>
            </div>
            
            <div class="blog-history">
                <h3>Previous Entries</h3>
                <div id="blogHistory">
                    <!-- Previous blog entries will appear here -->
                </div>
            </div>
        </div>

        <!-- NAVIGATION TABS HERE - ACTUALLY AT THE TOP NOW -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('tracker')">Tracker</button>
            <button class="tab-btn" onclick="switchTab('challenges')">Production Schedule</button>
            <button class="tab-btn" onclick="switchTab('recipes')">Recipes</button>
            <button class="tab-btn" onclick="switchTab('progress')">Progress</button>
            <button class="tab-btn" onclick="switchTab('achievements')">Achievements</button>
        </div>

        <!-- Wheel Section -->
        <div class="wheel-section">
            <h2 class="wheel-title">Choose Your Alternative</h2>
            <p class="wheel-subtitle">Instead of reaching for a drink, spin for a positive activity</p>
            
            <div class="wheel-container">
                <div class="wheel-pointer"></div>
                <div class="wheel" id="wheel">
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-segment"></div>
                    <div class="wheel-center">SPIN</div>
                    <div class="wheel-labels">
                        <div class="wheel-label">Guitar Track</div>
                        <div class="wheel-label">Drum Track</div>
                        <div class="wheel-label">Bass Track</div>
                        <div class="wheel-label">Walk</div>
                        <div class="wheel-label">Exercise</div>
                        <div class="wheel-label">Treat</div>
                        <div class="wheel-label">Vocals</div>
                    </div>
                </div>
            </div>
            
            <button class="spin-btn" id="spinBtn" onclick="spinWheel()">Spin the Wheel</button>
            
            <div class="wheel-result" id="wheelResult">
                <h3 id="resultTitle">Your Activity</h3>
                <p id="resultDescription"></p>
                <button class="btn btn-success" onclick="acceptActivity()">I'll Do This</button>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card highlight">
                <div class="stat-label">Current Streak</div>
                <div class="stat-value" id="streakCount">0</div>
                <div class="stat-subtext">days alcohol-free</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Productions Completed</div>
                <div class="stat-value" id="skillsCount">0</div>
                <div class="stat-subtext">tracks created</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Money Saved</div>
                <div class="stat-value">£<span id="moneySaved">0</span></div>
                <div class="stat-subtext">for the family</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Days for Kids</div>
                <div class="stat-value" id="daysForKids">0</div>
                <div class="stat-subtext">being present</div>
            </div>
        </div>

        <!-- Tracker Tab -->
        <div id="tracker" class="tab-content active">
            <div class="content-card">
                <h3>Today's Count</h3>
                <div class="drink-counter">
                    <button class="counter-btn minus" onclick="updateDrinks(-1)">−</button>
                    <div class="counter-display" id="drinkCount">0</div>
                    <button class="counter-btn plus" onclick="updateDrinks(1)">+</button>
                </div>
                <button class="btn btn-success btn-full" onclick="markDayFree()">
                    Mark as Alcohol-Free Day
                </button>
            </div>

            <div class="content-card">
                <h3>This Week</h3>
                <div class="calendar-grid" id="weekCalendar">
                    <!-- Calendar will be generated here -->
                </div>
            </div>

            <div class="content-card">
                <h3>30-Day Overview</h3>
                <div class="calendar-grid" style="grid-template-columns: repeat(10, 1fr);" id="monthCalendar">
                    <!-- 30-day calendar will be generated here -->
                </div>
            </div>
        </div>

        <!-- Production Schedule Tab -->
        <div id="challenges" class="tab-content">
            <div class="content-card">
                <h3>This Week's Production Schedule</h3>
                <div id="weeklyProductionSchedule">
                    <!-- Weekly production schedule will be generated here -->
                </div>
            </div>
            
            <div class="content-card">
                <h3>Today's Production Brief</h3>
                <div id="todayProduction">
                    <!-- Today's production brief will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Recipes Tab -->
        <div id="recipes" class="tab-content">
            <div class="content-card">
                <h3>Air Fryer Meal Plan - Healthy Eating for Max & Maisie's Dad</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Simple, healthy meals you can make quickly. Good nutrition supports your recovery and gives you energy to be present for your kids.
                </p>
            </div>

            <div class="content-card">
                <h3>Week 1 - Day by Day</h3>
                <div style="display: grid; gap: 20px;">
                    <!-- Day 1 -->
                    <div style="background: var(--bg-gray); padding: 20px; border-radius: 10px; border-left: 4px solid var(--primary-blue);">
                        <h4 style="color: var(--primary-blue); margin-bottom: 15px;">Day 1</h4>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <strong style="color: var(--accent-orange);">Breakfast: Air-Fried Boiled Eggs & Toast</strong>
                                <ul style="margin-top: 5px; margin-left: 20px; color: var(--text-secondary);">
                                    <li>Place 2 eggs in air fryer basket at 130°C (270°F) for 15 min</li>
                                    <li>Cool in cold water → peel</li>
                                    <li>Serve with 1 slice wholemeal toast + 1 banana</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: var(--secondary-green);">Lunch: Air-Fried Chicken Wrap</strong>
                                <ul style="margin-top: 5px; margin-left: 20px; color: var(--text-secondary);">
                                    <li>Season 1 chicken breast with olive oil spray, paprika, garlic powder</li>
                                    <li>Air fry at 190°C (375°F) for 16 min, flipping halfway</li>
                                    <li>Slice and serve in wholemeal wrap with salad + hummus</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: var(--primary-blue);">Dinner: Salmon & Veg</strong>
                                <ul style="margin-top: 5px; margin-left: 20px; color: var(--text-secondary);">
                                    <li>Place 1 salmon fillet in basket, season with lemon, salt, pepper</li>
                                    <li>Add 1 cup broccoli florets tossed in olive oil spray</li>
                                    <li>Air fry at 200°C (390°F) for 10–12 min</li>
                                </ul>
                            </div>
                            <div>
                                <strong style="color: var(--danger-red);">Snack: Air-Fried Chickpeas</strong>
                                <ul style="margin-top: 5px; margin-left: 20px; color: var(--text-secondary);">
                                    <li>Drain 1 can chickpeas, pat dry. Toss in paprika + oil spray</li>
                                    <li>Air fry 200°C (390°F) for 15 min, shake halfway</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Days 2-7 in similar format but condensed -->
                    <div style="background: var(--bg-gray); padding: 20px; border-radius: 10px;">
                        <h4 style="color: var(--primary-blue); margin-bottom: 15px;">Quick Reference - Days 2-7</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div>
                                <strong>Day 2</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Yogurt Bowl with berries & nuts<br>
                                    L: Air-Fried Falafel & Pita<br>
                                    D: Chicken Thighs & Sweet Potato
                                </p>
                            </div>
                            <div>
                                <strong>Day 3</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Overnight Oats Bake<br>
                                    L: Salmon Salad<br>
                                    D: Turkey Burger & Courgette Fries
                                </p>
                            </div>
                            <div>
                                <strong>Day 4</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Yogurt + Air-Fried Apple<br>
                                    L: Chicken Wrap (repeat)<br>
                                    D: Air-Fried Cod & Green Beans
                                </p>
                            </div>
                            <div>
                                <strong>Day 5</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Eggs & Toast<br>
                                    L: Falafel Salad Bowl<br>
                                    D: Tofu & Mixed Veg Stir Fry
                                </p>
                            </div>
                            <div>
                                <strong>Day 6</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Overnight Oats Bake slice<br>
                                    L: Chicken Wrap<br>
                                    D: Chicken Thighs & Wedges
                                </p>
                            </div>
                            <div>
                                <strong>Day 7</strong>
                                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                                    B: Yogurt + Berries<br>
                                    L: Salmon Wrap<br>
                                    D: Turkey Meatballs + Roast Veg
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-card">
                <h3>Master Shopping List (4 Weeks)</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px;">
                    <div>
                        <h4 style="color: var(--primary-blue); margin-bottom: 10px;">Proteins</h4>
                        <ul style="margin-left: 20px; color: var(--text-secondary); line-height: 1.8;">
                            <li>Chicken breast (6–8 pieces)</li>
                            <li>Chicken thighs (6–8 pieces)</li>
                            <li>Salmon fillets (6) / tuna steaks (2)</li>
                            <li>Turkey mince (500g packs × 2)</li>
                            <li>Cod fillets (2–3)</li>
                            <li>Tofu (2 blocks)</li>
                            <li>Eggs (2 dozen)</li>
                            <li>Greek yogurt (large tubs)</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--secondary-green); margin-bottom: 10px;">Carbs</h4>
                        <ul style="margin-left: 20px; color: var(--text-secondary); line-height: 1.8;">
                            <li>Wholemeal wraps (8–10)</li>
                            <li>Sweet potatoes (4–6)</li>
                            <li>Brown rice / quinoa (2 packs)</li>
                            <li>Oats (large bag)</li>
                            <li>Wholemeal bread (1–2 loaves)</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--accent-orange); margin-bottom: 10px;">Veggies</h4>
                        <ul style="margin-left: 20px; color: var(--text-secondary); line-height: 1.8;">
                            <li>Broccoli (2 heads)</li>
                            <li>Courgettes (4–5)</li>
                            <li>Carrots (6–8)</li>
                            <li>Mixed salad leaves (weekly bag)</li>
                            <li>Green beans (frozen or fresh)</li>
                            <li>Peppers (6–8)</li>
                            <li>Onions (3–4)</li>
                            <li>Frozen mixed veg (big bag)</li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--danger-red); margin-bottom: 10px;">Fruit & Extras</h4>
                        <ul style="margin-left: 20px; color: var(--text-secondary); line-height: 1.8;">
                            <li>Bananas (6–8)</li>
                            <li>Apples (6–8)</li>
                            <li>Berries (frozen, weekly bag)</li>
                            <li>Lemons (2–3)</li>
                            <li>Olive oil spray</li>
                            <li>Hummus</li>
                            <li>Chickpeas (2 cans)</li>
                            <li>Spices: paprika, cumin, garlic powder</li>
                            <li>Honey or maple syrup</li>
                            <li>Nuts (almonds/walnuts)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="content-card">
                <h3>Weeks 2-4 Variations</h3>
                <div style="background: var(--bg-gray); padding: 20px; border-radius: 10px;">
                    <p style="margin-bottom: 15px;"><strong>Week 2:</strong> Swap salmon for tuna steak; swap falafel with turkey meatballs; add pork chop + roasted parsnips dinner.</p>
                    <p style="margin-bottom: 15px;"><strong>Week 3:</strong> Breakfast banana + peanut butter toast; veggie fritters (grated carrot & courgette + egg + oats, 190°C for 12 min); chicken wings instead of thighs.</p>
                    <p><strong>Week 4:</strong> Breakfast air-fried apple slices with oats; salmon cakes (mix salmon + egg + breadcrumbs, form patties, air fry 190°C for 15 min); lamb kofta skewers.</p>
                </div>
            </div>
        </div>

        <!-- Progress Tab -->
        <div id="progress" class="tab-content">
            <div class="content-card">
                <h3>Your Journey So Far</h3>
                <div class="progress-item">
                    <span class="progress-label">Best Streak</span>
                    <span class="progress-value" id="bestStreak">0 days</span>
                </div>
                <div class="progress-item">
                    <span class="progress-label">Total Productions Completed</span>
                    <span class="progress-value" id="totalChallenges">0</span>
                </div>
                <div class="progress-item">
                    <span class="progress-label">Days Tracked</span>
                    <span class="progress-value" id="daysTracked">0</span>
                </div>
                <div class="progress-item">
                    <span class="progress-label">Alcohol-Free Days</span>
                    <span class="progress-value" id="totalFreeDays">0</span>
                </div>
                <div class="progress-item">
                    <span class="progress-label">Average Weekly Drinks</span>
                    <span class="progress-value" id="avgWeeklyDrinks">0</span>
                </div>
            </div>

            <div class="content-card">
                <h3>What This Means for Max & Maisie</h3>
                <p style="line-height: 1.8; color: var(--text-secondary);">
                    Every alcohol-free day is a day you're fully present for your children. 
                    Every production you complete is a piece of your musical legacy for them. 
                    Every pound saved can go towards their future. 
                    You're not just changing your life - you're shaping theirs.
                </p>
            </div>
        </div>

        <!-- Achievements Tab -->
        <div id="achievements" class="tab-content">
            <div class="content-card">
                <h3>Milestones Reached</h3>
                <div class="achievements-grid" id="achievementsGrid">
                    <!-- Achievements will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let appState = {
            currentStreak: 0,
            bestStreak: 0,
            skillsCompleted: 0,
            moneySaved: 0,
            todayDrinks: 0,
            dailyData: {},
            blogEntries: {},
            achievements: {},
            wheelSpinning: false
        };

        // Blog Prompts
        const blogPrompts = [
            "What would Max and Maisie be proud of you for today?",
            "Describe a moment today when you chose them over a drink.",
            "What new skill did you practice that you could teach your children?",
            "How did staying sober today make you a better father?",
            "What memory do you want Max and Maisie to have of today?",
            "Write a letter to your future self about why you're doing this.",
            "What triggered you today and how did you overcome it?",
            "Describe the father you want to be for Max and Maisie.",
            "What small victory can you celebrate today?",
            "How has your relationship with your children improved recently?"
        ];

        // Production Briefs - Full Logic Pro Templates
        const productionBriefs = [
            {
                id: 1,
                title: "Classic Rock Anthem",
                category: "Rock",
                tempo: "120 BPM",
                key: "A Major",
                structure: "Intro riff → Verse → Chorus → Solo → Outro",
                logic: {
                    drums: "Studio Kit (Bright) + room reverb",
                    bass: "Studio Bass (slight compression)",
                    rhythm: "Amp Designer 'British Crunch' panned L/R",
                    lead: "Amp Designer 'Boutique Lead', plate reverb"
                }
            },
            {
                id: 2,
                title: "Arena Ballad",
                category: "Rock",
                tempo: "80 BPM",
                key: "D Major",
                structure: "Clean intro → Verse → Big chorus → Solo → Outro fade",
                logic: {
                    drums: "Studio Kit (SoCal) with reverb",
                    bass: "Liverpool Bass with chorus",
                    rhythm: "Clean 'Ambient Tremolo' patch",
                    lead: "Lead with delay + reverb"
                }
            },
            {
                id: 3,
                title: "Grunge Jam",
                category: "Rock",
                tempo: "95 BPM",
                key: "E Minor",
                structure: "Verse (quiet) → Chorus (loud) → Outro jam",
                logic: {
                    drums: "SoCal Kit with dirt distortion",
                    bass: "Fuzz pedal + compression",
                    rhythm: "Clean chorus patch / Distorted 'Seattle Crunch'",
                    lead: "Seattle Crunch amp"
                }
            },
            {
                id: 4,
                title: "Stoner/Doom Groove",
                category: "Rock",
                tempo: "70 BPM",
                key: "C Minor",
                structure: "Riff loop → Breakdown → Return",
                logic: {
                    drums: "Heavy kit with long tom reverb",
                    bass: "Distorted bass amp, sustain notes",
                    rhythm: "Amp Designer 'Modern Stack', octave fuzz",
                    lead: "Modern Stack with fuzz"
                }
            },
            {
                id: 5,
                title: "Punk Energy",
                category: "Rock",
                tempo: "180 BPM",
                key: "G Major",
                structure: "Verse/Chorus loops, 2 min max",
                logic: {
                    drums: "Punk Kit, fast tight snare",
                    bass: "Pickstyle, light OD",
                    rhythm: "Garage Crunch",
                    lead: "Lead with delay"
                }
            },
            {
                id: 6,
                title: "Prog Rock Experiment",
                category: "Rock",
                tempo: "110 BPM",
                key: "7/8 in D Minor",
                structure: "Odd time riff → clean bridge → riff reprise",
                logic: {
                    drums: "Hybrid Kit with tom emphasis",
                    bass: "Prog patch with chorus",
                    rhythm: "Clean phaser tone",
                    lead: "Lead with delay + compression"
                }
            },
            {
                id: 7,
                title: "Surf Rock Vibes",
                category: "Rock",
                tempo: "140 BPM",
                key: "A Major",
                structure: "Riff intro → Verse → Solo → Outro fade",
                logic: {
                    drums: "Vintage kit, spring reverb",
                    bass: "Upright style (Retro Upright)",
                    rhythm: "Amp Designer 'Surf Verb' patch",
                    lead: "Surf Verb with tremolo"
                }
            },
            {
                id: 8,
                title: "Cinematic Rock Build",
                category: "Rock",
                tempo: "90 BPM",
                key: "C Major",
                structure: "Ambient intro → Build → Big chorus → Outro swell",
                logic: {
                    drums: "Roomy SoCal Kit",
                    bass: "Sub bass layered with electric",
                    rhythm: "Ambient delay swells",
                    lead: "Octave riff, distortion"
                }
            },
            {
                id: 9,
                title: "Slow Blues in A",
                category: "Blues",
                tempo: "65 BPM",
                key: "A",
                structure: "12-bar loop",
                logic: {
                    drums: "Blues Shuffle preset",
                    bass: "Upright bass sim",
                    rhythm: "Amp Designer 'Tweed Blues'",
                    lead: "Tweed Blues with reverb"
                }
            },
            {
                id: 10,
                title: "Texas Shuffle",
                category: "Blues",
                tempo: "115 BPM",
                key: "G",
                structure: "12-bar blues w/ call & response",
                logic: {
                    drums: "Tight shuffle groove",
                    bass: "Walking shuffle",
                    rhythm: "Amp Designer 'SRV Texas' tone",
                    lead: "SRV Texas with tube screamer"
                }
            },
            {
                id: 11,
                title: "Chicago Blues Jam",
                category: "Blues",
                tempo: "105 BPM",
                key: "E",
                structure: "12-bar w/ solos rotating",
                logic: {
                    drums: "Studio Kit, light reverb",
                    bass: "Upright walking",
                    rhythm: "Clean comping",
                    lead: "Lead guitar with delay"
                }
            },
            {
                id: 12,
                title: "Modern Blues Rock",
                category: "Blues",
                tempo: "100 BPM",
                key: "D Minor",
                structure: "Riff intro → Verse → Chorus → Solo → Outro",
                logic: {
                    drums: "Rock Kit, roomy snare",
                    bass: "Aggressive pickstyle",
                    rhythm: "Rhythm crunch",
                    lead: "High-gain lead"
                }
            },
            {
                id: 13,
                title: "Funky Blues Fusion",
                category: "Blues",
                tempo: "110 BPM",
                key: "C Minor",
                structure: "Jam loop (verse/chorus optional)",
                logic: {
                    drums: "Funk Kit, ghost notes",
                    bass: "Slap tone",
                    rhythm: "Wah rhythm + clean comping",
                    lead: "Wah lead with compression"
                }
            },
            {
                id: 14,
                title: "Delta Blues Style",
                category: "Blues",
                tempo: "75 BPM",
                key: "Open G",
                structure: "12-bar fingerpicked",
                logic: {
                    drums: "Light kick/snare brushes",
                    bass: "Upright subtle",
                    rhythm: "Slide guitar patch",
                    lead: "Compressor + spring verb"
                }
            },
            {
                id: 15,
                title: "Indie Dance Rock",
                category: "Dance/Rock",
                tempo: "125 BPM",
                key: "B Minor",
                structure: "Build intro → Drop chorus → Break → Drop return",
                logic: {
                    drums: "EDM kick layered with live kit",
                    bass: "Octave disco line",
                    rhythm: "Clean chorus + delay stabs",
                    lead: "Delayed lead lines"
                }
            },
            {
                id: 16,
                title: "Funk Rock Jam",
                category: "Dance/Rock",
                tempo: "110 BPM",
                key: "E",
                structure: "Verse/Chorus jam",
                logic: {
                    drums: "Funk kit with sidechain comp",
                    bass: "Slap tone",
                    rhythm: "Muted funk comping with wah",
                    lead: "Wah lead solos"
                }
            },
            {
                id: 17,
                title: "Dance-Punk Energy",
                category: "Dance/Rock",
                tempo: "135 BPM",
                key: "F# Minor",
                structure: "Short verse/chorus loops",
                logic: {
                    drums: "Electronic hi-hats + live kit",
                    bass: "Eighth-note driving line",
                    rhythm: "Staccato chords with fuzz",
                    lead: "Fuzz lead bursts"
                }
            },
            {
                id: 18,
                title: "Blues-Dance Crossover",
                category: "Dance/Rock",
                tempo: "118 BPM",
                key: "A Minor",
                structure: "12-bar loop w/ electronic drops",
                logic: {
                    drums: "Shuffle layered with EDM kick",
                    bass: "Blues walking line",
                    rhythm: "Distorted licks + delay FX",
                    lead: "Blues lead with effects"
                }
            },
            {
                id: 19,
                title: "Garage Rock Club Track",
                category: "Dance/Rock",
                tempo: "140 BPM",
                key: "G Major",
                structure: "Fast verse/chorus jam",
                logic: {
                    drums: "Garage kit, gritty snare",
                    bass: "Fuzz bass",
                    rhythm: "Lo-fi crunch",
                    lead: "Lead with delay"
                }
            },
            {
                id: 20,
                title: "Electronic Rock Hybrid",
                category: "Dance/Rock",
                tempo: "128 BPM",
                key: "D Minor",
                structure: "Intro build → Drop riff → Bridge → Drop return",
                logic: {
                    drums: "Layered electronic + live kit",
                    bass: "Sub bass + distorted bass guitar",
                    rhythm: "Distorted lead layered with synth",
                    lead: "Synth/guitar hybrid lead"
                }
            }
        ];

        const achievementsList = [
            { id: 'first_day', name: 'Day One', description: 'First alcohol-free day', requirement: 1 },
            { id: 'three_days', name: 'Hat Trick', description: '3 days streak', requirement: 3 },
            { id: 'one_week', name: 'Full Week', description: '7 days streak', requirement: 7 },
            { id: 'two_weeks', name: 'Fortnight', description: '14 days streak', requirement: 14 },
            { id: 'one_month', name: 'Monthly Hero', description: '30 days streak', requirement: 30 },
            { id: 'three_months', name: 'Quarter Year', description: '90 days streak', requirement: 90 },
            { id: 'first_skill', name: 'First Track', description: 'Complete first production', requirement: 1, type: 'skills' },
            { id: 'five_skills', name: 'Producer', description: '5 tracks completed', requirement: 5, type: 'skills' },
            { id: 'ten_skills', name: 'Studio Pro', description: '10 tracks completed', requirement: 10, type: 'skills' },
            { id: 'money_50', name: 'Saver', description: 'Save £50', requirement: 50, type: 'money' },
            { id: 'money_200', name: 'Provider', description: 'Save £200', requirement: 200, type: 'money' },
            { id: 'money_500', name: 'Family Fund', description: 'Save £500', requirement: 500, type: 'money' }
        ];

        // Initialize
        function initApp() {
            loadState();
            updateDisplay();
            setTodayDate();
            setDailyPrompt();
            loadBlogHistory();
            generateWeeklyProduction();
            generateWeekCalendar();
            generateMonthCalendar();
            displayAchievements();
            checkNewDay();
        }

        // Load state
        function loadState() {
            const saved = localStorage.getItem('lastOrdersState');
            if (saved) {
                appState = { ...appState, ...JSON.parse(saved) };
            }
        }

        // Save state
        function saveState() {
            localStorage.setItem('lastOrdersState', JSON.stringify(appState));
        }

        // Set today's date
        function setTodayDate() {
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('todayDate').textContent = today.toLocaleDateString('en-GB', options);
        }

        // Set daily prompt
        function setDailyPrompt() {
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            const prompt = blogPrompts[dayOfYear % blogPrompts.length];
            document.getElementById('blogPrompt').textContent = `Today's prompt: ${prompt}`;
        }

        // Blog functions
        function saveBlog() {
            const content = document.getElementById('dailyBlog').value;
            if (!content.trim()) {
                alert('Please write something in your daily reflection.');
                return;
            }
            
            const today = new Date().toDateString();
            appState.blogEntries[today] = {
                content: content,
                timestamp: new Date().toISOString()
            };
            
            saveState();
            loadBlogHistory();
            document.getElementById('dailyBlog').value = '';
            alert('Entry saved. Keep reflecting on your journey.');
        }

        function clearBlog() {
            document.getElementById('dailyBlog').value = '';
        }

        function loadBlogHistory() {
            const historyDiv = document.getElementById('blogHistory');
            const entries = Object.entries(appState.blogEntries).sort((a, b) => 
                new Date(b[1].timestamp) - new Date(a[1].timestamp)
            ).slice(0, 5);
            
            if (entries.length === 0) {
                historyDiv.innerHTML = '<p style="color: var(--text-muted);">No previous entries yet. Start writing today!</p>';
                return;
            }
            
            historyDiv.innerHTML = entries.map(([date, entry]) => `
                <div class="blog-entry">
                    <div class="blog-entry-date">${new Date(date).toLocaleDateString('en-GB', { 
                        weekday: 'long', 
                        day: 'numeric', 
                        month: 'long' 
                    })}</div>
                    <div class="blog-entry-text">${entry.content}</div>
                </div>
            `).join('');
        }

        // Generate Weekly Production Schedule
        function generateWeeklyProduction() {
            const weekSchedule = document.getElementById('weeklyProductionSchedule');
            const todayProd = document.getElementById('todayProduction');
            
            if (!weekSchedule || !todayProd) return;
            
            // Get current week number of the year
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            const diff = now - start;
            const weekNumber = Math.floor(diff / (1000 * 60 * 60 * 24 * 7));
            
            // Generate consistent weekly schedule based on week number
            const weekdays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            const dayIndex = now.getDay() - 1; // Monday = 0
            
            // Create a shuffled array of production briefs for this week
            const shuffledBriefs = [...productionBriefs];
            // Use week number as seed for consistent weekly shuffle
            const seed = weekNumber;
            for (let i = shuffledBriefs.length - 1; i > 0; i--) {
                const j = Math.floor(((seed * (i + 1)) % 100) / 100 * (i + 1));
                [shuffledBriefs[i], shuffledBriefs[j]] = [shuffledBriefs[j], shuffledBriefs[i]];
            }
            
            // Select 5 briefs for this week
            const weekBriefs = shuffledBriefs.slice(0, 5);
            
            // Generate weekly schedule HTML
            let scheduleHTML = '<div style="display: grid; gap: 15px;">';
            
            weekdays.forEach((day, index) => {
                const brief = weekBriefs[index];
                const isToday = index === dayIndex;
                
                scheduleHTML += `
                    <div style="padding: 20px; background: ${isToday ? 'var(--primary-blue)' : 'var(--bg-gray)'}; 
                                color: ${isToday ? 'white' : 'var(--text-primary)'}; 
                                border-radius: 10px; border-left: 5px solid ${getCategoryColor(brief.category)};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; font-size: 1.2rem;">${day}</h4>
                            ${isToday ? '<span style="background: white; color: var(--primary-blue); padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold;">TODAY</span>' : ''}
                        </div>
                        <div style="font-weight: 600; margin-bottom: 5px;">${brief.title}</div>
                        <div style="opacity: 0.9; font-size: 0.9rem;">${brief.category} • ${brief.tempo} • ${brief.key}</div>
                    </div>
                `;
            });
            
            scheduleHTML += '</div>';
            weekSchedule.innerHTML = scheduleHTML;
            
            // Display today's production brief in detail
            if (dayIndex >= 0 && dayIndex < 5) {
                const todayBrief = weekBriefs[dayIndex];
                
                const todayHTML = `
                    <div style="background: linear-gradient(135deg, ${getCategoryColor(todayBrief.category)}, ${getCategoryColorLight(todayBrief.category)}); 
                                color: white; padding: 25px; border-radius: 12px; margin-bottom: 20px;">
                        <h2 style="margin: 0 0 10px 0; font-size: 1.8rem;">${todayBrief.title}</h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div>
                                <span style="opacity: 0.8; font-size: 0.9rem;">Category</span>
                                <div style="font-weight: bold;">${todayBrief.category}</div>
                            </div>
                            <div>
                                <span style="opacity: 0.8; font-size: 0.9rem;">Tempo</span>
                                <div style="font-weight: bold;">${todayBrief.tempo}</div>
                            </div>
                            <div>
                                <span style="opacity: 0.8; font-size: 0.9rem;">Key</span>
                                <div style="font-weight: bold;">${todayBrief.key}</div>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px;">
                            <strong>Structure:</strong> ${todayBrief.structure}
                        </div>
                    </div>
                    
                    <div style="background: var(--bg-gray); padding: 25px; border-radius: 12px;">
                        <h3 style="color: var(--primary-blue); margin-bottom: 20px;">Logic Pro Template Setup</h3>
                        
                        <div style="display: grid; gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid var(--accent-orange);">
                                <strong style="color: var(--text-primary); display: block; margin-bottom: 5px;">Track 1: V-Drums</strong>
                                <span style="color: var(--text-secondary);">${todayBrief.logic.drums}</span>
                            </div>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid var(--secondary-green);">
                                <strong style="color: var(--text-primary); display: block; margin-bottom: 5px;">Track 2: Bass</strong>
                                <span style="color: var(--text-secondary);">${todayBrief.logic.bass}</span>
                            </div>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-blue);">
                                <strong style="color: var(--text-primary); display: block; margin-bottom: 5px;">Track 3-4: Rhythm Guitar</strong>
                                <span style="color: var(--text-secondary);">${todayBrief.logic.rhythm}</span>
                            </div>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid var(--danger-red);">
                                <strong style="color: var(--text-primary); display: block; margin-bottom: 5px;">Track 5: Lead Guitar</strong>
                                <span style="color: var(--text-secondary);">${todayBrief.logic.lead}</span>
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" style="margin-top: 25px; width: 100%;" onclick="startProduction('${todayBrief.title}')">
                            Start This Production
                        </button>
                    </div>
                `;
                
                todayProd.innerHTML = todayHTML;
            } else {
                // Weekend message
                todayProd.innerHTML = `
                    <div style="text-align: center; padding: 40px; background: var(--bg-gray); border-radius: 12px;">
                        <h3 style="color: var(--primary-blue);">It's the Weekend!</h3>
                        <p style="color: var(--text-secondary); margin: 20px 0;">
                            Take time to review this week's productions, practice your favorites, 
                            or just relax with Max and Maisie. Your next production brief starts Monday.
                        </p>
                        <p style="font-size: 1.2rem; color: var(--secondary-green); font-weight: bold;">
                            Enjoy your weekend - you've earned it!
                        </p>
                    </div>
                `;
            }
        }
        
        // Helper functions for colors
        function getCategoryColor(category) {
            switch(category) {
                case 'Rock': return '#ef4444';
                case 'Blues': return '#3b82f6';
                case 'Dance/Rock': return '#a855f7';
                default: return '#6b7280';
            }
        }
        
        function getCategoryColorLight(category) {
            switch(category) {
                case 'Rock': return '#f87171';
                case 'Blues': return '#60a5fa';
                case 'Dance/Rock': return '#c084fc';
                default: return '#9ca3af';
            }
        }
        
        // Start production
        function startProduction(title) {
            appState.skillsCompleted++;
            updateDisplay();
            checkAchievements();
            saveState();
            alert(`Excellent! Open Logic Pro and set up the "${title}" template. Remember:\n\n1. Set the tempo and key\n2. Create your tracks with the specified plugins\n3. Record your parts\n4. Save it for Max and Maisie to hear!\n\nThis is building your musical legacy.`);
        }

        // Wheel functions
        function spinWheel() {
            if (appState.wheelSpinning) return;
            
            appState.wheelSpinning = true;
            const wheel = document.getElementById('wheel');
            const spinBtn = document.getElementById('spinBtn');
            const resultDiv = document.getElementById('wheelResult');
            
            spinBtn.disabled = true;
            resultDiv.classList.remove('show');
            
            // Random selection
            const options = [
                'Guitar Track', 'Drum Track', 'Bass Track', 'Walk', 
                'Exercise', 'Treat', 'Vocals'
            ];
            
            const selectedIndex = Math.floor(Math.random() * options.length);
            const degrees = selectedIndex * (360 / 7);
            const spins = 5 + Math.random() * 5;
            const totalRotation = spins * 360 + degrees;
            
            wheel.style.transition = 'transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)';
            wheel.style.transform = `rotate(${totalRotation}deg)`;
            
            setTimeout(() => {
                const selected = options[selectedIndex];
                showResult(selected);
                
                appState.wheelSpinning = false;
                spinBtn.disabled = false;
                
                // Reset for next spin
                setTimeout(() => {
                    wheel.style.transition = 'none';
                    wheel.style.transform = `rotate(${degrees}deg)`;
                }, 100);
            }, 4000);
        }

        function showResult(activity) {
            const resultDiv = document.getElementById('wheelResult');
            const descriptions = {
                'Guitar Track': 'Work on today\'s production brief guitar parts. Load up Logic Pro and nail those riffs.',
                'Drum Track': 'Focus on the drum patterns in today\'s production. Fire up your V-Drums and lay down the beat.',
                'Bass Track': 'Lock in the bass groove for today\'s track. Get that low end pumping in Logic Pro.',
                'Walk': 'Take a 20-minute walk. Clear your head, get some fresh air, think about Max and Maisie.',
                'Exercise': 'Do 20 push-ups, 30 sit-ups, or any physical activity for 10 minutes. Get your heart pumping.',
                'Treat': 'Have a healthy snack or treat yourself to something nice. Check the Recipes tab for healthy air fryer snacks.',
                'Vocals': 'Add vocals to one of your productions. Belt it out, express yourself, make it personal.'
            };
            
            document.getElementById('resultTitle').textContent = activity;
            document.getElementById('resultDescription').textContent = descriptions[activity];
            resultDiv.classList.add('show');
        }

        function acceptActivity() {
            appState.skillsCompleted++;
            updateDisplay();
            checkAchievements();
            saveState();
            alert('Great choice! Every positive activity moves you forward. Check the Production Schedule for today\'s music brief and the Recipes tab for healthy meal ideas.');
        }

        // Update display
        function updateDisplay() {
            document.getElementById('streakCount').textContent = appState.currentStreak;
            document.getElementById('skillsCount').textContent = appState.skillsCompleted;
            document.getElementById('moneySaved').textContent = appState.moneySaved;
            document.getElementById('daysForKids').textContent = appState.currentStreak;
            document.getElementById('drinkCount').textContent = appState.todayDrinks;
            
            updateProgressStats();
        }

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Find and activate the correct button
            const tabButtons = {
                'tracker': 'Tracker',
                'challenges': 'Production Schedule',
                'recipes': 'Recipes',
                'progress': 'Progress',
                'achievements': 'Achievements'
            };
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.textContent === tabButtons[tabName]) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        // Update progress stats
        function updateProgressStats() {
            const totalDays = Object.keys(appState.dailyData).length;
            const freeDays = Object.values(appState.dailyData).filter(d => d.free).length;
            const totalDrinks = Object.values(appState.dailyData).reduce((sum, d) => sum + (d.drinks || 0), 0);
            const avgWeekly = totalDays > 0 ? Math.round((totalDrinks / totalDays) * 7) : 0;
            
            document.getElementById('bestStreak').textContent = appState.bestStreak + ' days';
            document.getElementById('totalChallenges').textContent = appState.skillsCompleted;
            document.getElementById('daysTracked').textContent = totalDays;
            document.getElementById('totalFreeDays').textContent = freeDays;
            document.getElementById('avgWeeklyDrinks').textContent = avgWeekly;
        }

        // Update drinks
        function updateDrinks(change) {
            appState.todayDrinks = Math.max(0, appState.todayDrinks + change);
            const today = new Date().toDateString();
            appState.dailyData[today] = { ...appState.dailyData[today], drinks: appState.todayDrinks };
            
            updateDisplay();
            generateWeekCalendar();
            generateMonthCalendar();
            saveState();
        }

        // Mark day free
        function markDayFree() {
            const today = new Date().toDateString();
            appState.todayDrinks = 0;
            appState.dailyData[today] = { drinks: 0, free: true };
            
            // Update streak
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayData = appState.dailyData[yesterday.toDateString()];
            
            if (yesterdayData && yesterdayData.free) {
                appState.currentStreak++;
            } else {
                appState.currentStreak = 1;
            }
            
            appState.bestStreak = Math.max(appState.bestStreak, appState.currentStreak);
            appState.moneySaved += 12; // £12 per day saved
            
            updateDisplay();
            generateWeekCalendar();
            generateMonthCalendar();
            checkAchievements();
            saveState();
            
            alert(`Excellent! Day ${appState.currentStreak} alcohol-free. Max and Maisie have a present, focused father today.`);
        }

        // Generate calendars
        function generateWeekCalendar() {
            const calendar = document.getElementById('weekCalendar');
            if (!calendar) return;
            
            calendar.innerHTML = '';
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const today = new Date();
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - today.getDay());
            
            days.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                calendar.appendChild(header);
            });
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dateString = date.toDateString();
                const dayData = appState.dailyData[dateString] || {};
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                if (dayData.free) {
                    dayDiv.classList.add('free');
                } else if (dayData.drinks > 3) {
                    dayDiv.classList.add('heavy');
                } else if (dayData.drinks > 0) {
                    dayDiv.classList.add('partial');
                }
                
                dayDiv.textContent = date.getDate();
                dayDiv.title = dayData.free ? 'Alcohol-free' : `${dayData.drinks || 0} drinks`;
                
                calendar.appendChild(dayDiv);
            }
        }

        function generateMonthCalendar() {
            const calendar = document.getElementById('monthCalendar');
            if (!calendar) return;
            
            calendar.innerHTML = '';
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - i);
                const dateString = date.toDateString();
                const dayData = appState.dailyData[dateString] || {};
                
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                if (dayData.free) {
                    dayDiv.classList.add('free');
                } else if (dayData.drinks > 3) {
                    dayDiv.classList.add('heavy');
                } else if (dayData.drinks > 0) {
                    dayDiv.classList.add('partial');
                }
                
                dayDiv.textContent = date.getDate();
                
                calendar.appendChild(dayDiv);
            }
        }

        // Display achievements
        function displayAchievements() {
            const grid = document.getElementById('achievementsGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            achievementsList.forEach(achievement => {
                const card = document.createElement('div');
                card.className = 'achievement-card';
                
                let unlocked = false;
                if (achievement.type === 'skills') {
                    unlocked = appState.skillsCompleted >= achievement.requirement;
                } else if (achievement.type === 'money') {
                    unlocked = appState.moneySaved >= achievement.requirement;
                } else {
                    unlocked = appState.currentStreak >= achievement.requirement || 
                               appState.bestStreak >= achievement.requirement;
                }
                
                if (unlocked) card.classList.add('unlocked');
                
                card.innerHTML = `
                    <div class="achievement-name">${achievement.name}</div>
                    <div class="achievement-desc">${achievement.description}</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Check achievements
        function checkAchievements() {
            displayAchievements();
        }

        // Check new day
        function checkNewDay() {
            const today = new Date().toDateString();
            const lastCheck = localStorage.getItem('lastOrdersLastCheck');
            
            if (lastCheck !== today) {
                appState.todayDrinks = 0;
                
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayData = appState.dailyData[yesterday.toDateString()];
                
                if (!yesterdayData || !yesterdayData.free) {
                    if (appState.currentStreak > 0) {
                        appState.currentStreak = 0;
                    }
                }
                
                localStorage.setItem('lastOrdersLastCheck', today);
                setDailyPrompt();
                generateWeeklyProduction();
                saveState();
            }
        }

        // Initialize on load
        window.onload = initApp;
    </script>
</body>
</html>